$ python SeqXGPT/train.py --split_dataset --data_path dataset/processed_data --train_path dataset/processed_data/train.jsonl --test_path dataset/processed_data/test.jsonl --gpu=0
Log INFO: split dataset...
********************************
The overall data sources:
['en_gpt2_lines.jsonl', 'en_gpt3_lines.jsonl', 'en_human_lines.jsonl', 'en_llama_lines.jsonl', 'test.jsonl', 'train.jsonl']
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 64516/64516 [00:08<00:00, 7724.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 7169/7169 [00:00<00:00, 7951.90it/s] 

The number of train dataset: 64516
The number of test  dataset: 7169
********************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 64516/64516 [00:09<00:00, 7157.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 7169/7169 [00:01<00:00, 5820.30it/s]
total train samples: 23815
Overlap between train and test: 6410 samples
--------------------------------classify--------------------------------
--------------------------------Transformer--------------------------------
Log INFO: do train...
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:12<00:00, 27.64it/s]
Epoch 1: train_loss 2.1670████████████████████████████████████████████████████████████████████████████▉| 2015/2017 [01:12<00:00, 26.81it/s]
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.08it/s]
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.40it/s]
Accuracy: 33.2
Macro F1 Score: 23.0
Precision/Recall per class:
34.8/1.1 0.0/0.0 61.2/37.9 27.8/93.8
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:13<00:00, 27.59it/s]
Epoch 2: train_loss 1.3570████████████████████████████████████████████████████████████████████████████▊| 2014/2017 [01:13<00:00, 23.70it/s]
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:43<00:00,  5.14it/s] 
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:43<00:00,  5.56it/s] 
Accuracy: 41.1
Macro F1 Score: 37.1
Precision/Recall per class:
44.2/43.8 24.8/4.5 60.9/45.6 33.3/68.3
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:14<00:00, 27.11it/s] 
Epoch 3: train_loss 1.2710████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 2014/2017 [01:14<00:00, 26.06it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.10it/s] 
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.37it/s] 
Accuracy: 41.1
Macro F1 Score: 37.7
Precision/Recall per class: 
43.1/47.0 24.9/6.2 64.7/42.2 33.6/66.7
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:15<00:00, 26.88it/s]
Epoch 4: train_loss 1.2565████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 2014/2017 [01:14<00:00, 26.36it/s]
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.07it/s]
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.72it/s] 
Accuracy: 41.4
Macro F1 Score: 36.8
Precision/Recall per class: 
43.3/45.6 27.1/2.7 60.7/46.8 33.4/68.0
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:34<00:00, 21.38it/s]
Epoch 5: train_loss 1.2484████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2016/2017 [01:34<00:00, 27.29it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:43<00:00,  5.13it/s]
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:43<00:00,  5.39it/s] 
Accuracy: 42.1
Macro F1 Score: 38.1
Precision/Recall per class: 
41.2/54.0 31.3/5.0 62.3/46.1 34.7/60.3
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:13<00:00, 27.33it/s]
Epoch 6: train_loss 1.2439████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 2014/2017 [01:13<00:00, 27.77it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.08it/s]
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.27it/s] 
Accuracy: 41.8
Macro F1 Score: 37.8
Precision/Recall per class: 
42.8/47.3 40.6/5.1 67.3/43.0 33.1/69.4
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:15<00:00, 26.67it/s]
Epoch 7: train_loss 1.2416████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 2014/2017 [01:15<00:00, 27.34it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:45<00:00,  4.94it/s]
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:45<00:00,  4.98it/s] 
Accuracy: 42.2
Macro F1 Score: 37.9
Precision/Recall per class: 
42.9/48.8 44.6/4.3 63.8/45.3 33.7/68.0
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:14<00:00, 27.15it/s]
Epoch 8: train_loss 1.2398████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2016/2017 [01:14<00:00, 23.24it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.03it/s]
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.19it/s] 
Accuracy: 41.9
Macro F1 Score: 38.2
Precision/Recall per class: 
43.2/46.4 41.8/6.2 65.7/43.8 33.2/69.1
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:15<00:00, 26.87it/s]
Epoch 9: train_loss 1.2388████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 2015/2017 [01:15<00:00, 27.23it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:45<00:00,  4.98it/s]
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:45<00:00,  5.52it/s] 
Accuracy: 42.1
Macro F1 Score: 38.0
Precision/Recall per class: 
43.3/46.1 44.2/5.2 65.9/44.4 33.3/70.1
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:14<00:00, 27.04it/s]
Epoch 10: train_loss 1.2379███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 2014/2017 [01:14<00:00, 27.31it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.09it/s]
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  6.01it/s] 
Accuracy: 42.5
Macro F1 Score: 38.3
Precision/Recall per class: 
42.9/48.6 45.2/4.9 61.2/48.1 34.0/65.5
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:14<00:00, 26.94it/s]
Epoch 11: train_loss 1.2374███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 2014/2017 [01:14<00:00, 27.89it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:45<00:00,  4.99it/s]
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:45<00:00,  5.16it/s] 
Accuracy: 42.1
Macro F1 Score: 38.0
Precision/Recall per class: 
42.9/47.1 44.2/5.2 62.6/46.5 33.4/66.8
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:15<00:00, 26.59it/s]
Epoch 12: train_loss 1.2368███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 2015/2017 [01:15<00:00, 26.18it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.06it/s]
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.53it/s] 
Accuracy: 42.2
Macro F1 Score: 38.2
Precision/Recall per class: 
42.9/47.9 44.4/5.2 62.7/46.5 33.7/66.8
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:14<00:00, 27.19it/s]
Epoch 13: train_loss 1.2368███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2016/2017 [01:14<00:00, 26.11it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:43<00:00,  5.12it/s]
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:43<00:00,  5.36it/s] 
Accuracy: 42.1
Macro F1 Score: 38.3
Precision/Recall per class: 
42.8/47.7 43.2/5.8 65.1/44.4 33.5/68.0
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:15<00:00, 26.82it/s]
Epoch 14: train_loss 1.2367███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 2015/2017 [01:15<00:00, 27.10it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.09it/s]
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.39it/s] 
Accuracy: 42.4
Macro F1 Score: 38.2
Precision/Recall per class: 
42.9/48.3 45.2/4.9 61.5/47.7 33.9/65.9
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:14<00:00, 27.24it/s]
Epoch 15: train_loss 1.2358███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 2014/2017 [01:13<00:00, 26.80it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:43<00:00,  5.12it/s]
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:43<00:00,  5.68it/s] 
Accuracy: 42.3
Macro F1 Score: 38.4
Precision/Recall per class: 
42.9/48.7 44.2/5.7 63.9/45.3 33.7/66.9
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:13<00:00, 27.41it/s]
Epoch 16: train_loss 1.2364███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2016/2017 [01:13<00:00, 27.11it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:45<00:00,  4.98it/s]
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:45<00:00,  5.29it/s] 
Accuracy: 42.0
Macro F1 Score: 38.0
Precision/Recall per class: 
42.9/47.0 44.4/5.2 63.4/45.8 33.3/67.4
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:14<00:00, 27.15it/s]
Epoch 17: train_loss 1.2359███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 2015/2017 [01:14<00:00, 23.67it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:43<00:00,  5.13it/s]
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:43<00:00,  5.44it/s] 
Accuracy: 42.3
Macro F1 Score: 38.3
Precision/Recall per class: 
42.9/48.0 44.1/5.3 62.1/47.1 33.8/66.2
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:15<00:00, 26.83it/s]
Epoch 18: train_loss 1.2358███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2016/2017 [01:15<00:00, 26.26it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:45<00:00,  4.97it/s]
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:45<00:00,  4.65it/s] 
Accuracy: 42.4
Macro F1 Score: 38.4
Precision/Recall per class: 
43.2/49.2 44.2/5.2 62.5/46.7 33.8/66.0
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:14<00:00, 27.22it/s] 
Epoch 19: train_loss 1.2353███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2016/2017 [01:14<00:00, 27.04it/s] 
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:14<00:00, 27.22it/s] 
Epoch 19: train_loss 1.2353███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2016/2017 [01:14<00:00, 27.04it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.03it/s] 
Epoch 19: train_loss 1.2353███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2016/2017 [01:14<00:00, 27.04it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.03it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  5.03it/s] 
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  3.52it/s] 
Accuracy: 42.3
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:44<00:00,  3.52it/s] 
Accuracy: 42.3
Macro F1 Score: 38.3
Accuracy: 42.3
Macro F1 Score: 38.3
Macro F1 Score: 38.3
Precision/Recall per class:
43.0/48.7 43.6/5.3 62.5/46.3 33.8/66.3
Precision/Recall per class:
43.0/48.7 43.6/5.3 62.5/46.3 33.8/66.3
43.0/48.7 43.6/5.3 62.5/46.3 33.8/66.3
Model saved to checkpoint/transformer_cls_model.pt
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
********************************************************************************
Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2017/2017 [01:13<00:00, 27.29it/s] 
Epoch 20: train_loss 1.2349███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2016/2017 [01:13<00:00, 25.35it/s] 
Epoch 20: train_loss 1.2349███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 2016/2017 [01:13<00:00, 25.35it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:45<00:00,  4.99it/s] 
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:45<00:00,  4.99it/s] 
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:45<00:00,  5.33it/s] 
******** Sentence Level Evalation ********███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 225/225 [00:45<00:00,  5.33it/s] 
Accuracy: 42.4
Macro F1 Score: 38.4
Precision/Recall per class:
43.0/48.7 44.1/5.3 62.2/47.1 33.9/65.9
Model saved to checkpoint/transformer_cls_model.pt
********************************************************************************
Epoch: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [1:15:55<00:00, 227.75s/it]
Training finished.